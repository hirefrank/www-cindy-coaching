---
import Layout from "../layouts/Layout.astro";
import { getAboutContent } from "../lib/cosmic";

// Fetch content from Cosmic
const aboutData = await getAboutContent();

// Extract content with fallbacks
const headline = aboutData?.metadata?.headline || "From Physical Therapist to ADHD Coach";
const description = aboutData?.metadata?.description || "Discover how 25+ years of pediatric physical therapy experience led me to become an ICF certified ADHD coach, bridging brain science with practical daily strategies.";

// Personal section
const personalHeader = aboutData?.metadata?.personal?.header || "The Personal Journey";
const personalContent = aboutData?.metadata?.personal?.content || "";

// Professional section
const professionalHeader = aboutData?.metadata?.professional?.header || "Professional Evolution";
const professionalContent = aboutData?.metadata?.professional?.content || "";

// Certifications section
const certificationsHeader = aboutData?.metadata?.certifications?.header || "Credentials & Training";
const certificationsDescription = aboutData?.metadata?.certifications?.description || "";
const certificationsContent = aboutData?.metadata?.certifications?.content || [];

// Approach section
const approachHeader = aboutData?.metadata?.approach?.header || "My Approach & Philosophy";
const approachDescription = aboutData?.metadata?.approach?.description || "";
const approachContent = aboutData?.metadata?.approach?.content || [];

// Beyond section
const beyondHeader = aboutData?.metadata?.beyond?.header || "Beyond the Professional";
const beyondDescription = aboutData?.metadata?.beyond?.description || "";

// Helper function to format content into paragraphs
const formatParagraphs = (content: string) => {
    return content.split('\n\n').filter((para: string) => para.trim());
};
---

<Layout
    title="About - Mindful Balance ADHD Coaching"
    description={description}
>
    <!-- Hero Section -->
    <section
        class="section-padding bg-gradient-to-b from-muted/30 to-background"
    >
        <div class="max-w-4xl mx-auto container-padding text-center">
            <h1 class="mb-24">{headline}</h1>
            <p class="text-xl text-muted-foreground leading-relaxed">
                {description}
            </p>
        </div>
    </section>

    <!-- Personal Journey -->
    <section class="py-48">
        <div class="max-w-6xl mx-auto container-padding">
            <div
                class="grid grid-cols-1 lg:grid-cols-2 gap-48 items-center mb-64"
            >
                <div>
                    <h2 class="mb-24">{personalHeader}</h2>
                    {formatParagraphs(personalContent).map((paragraph: string) => (
                        <p class="text-lg text-muted-foreground mb-24 leading-relaxed">
                            {paragraph}
                        </p>
                    ))}
                </div>

                <div class="relative">
                    <div
                        class="aspect-[4/3] bg-gradient-to-br from-primary/10 to-secondary/10 rounded-3xl p-6 overflow-hidden"
                    >
                        <img
                            src="/images/2023-03-29_CIndy_Romanzo_Headshots_WEB.jpg"
                            alt="Cindy Romanzo - Personal Journey"
                            class="w-full h-full object-cover rounded-2xl shadow-lg scale-[1.15] object-center"
                        />
                    </div>
                </div>
            </div>

            <!-- Professional Evolution -->
            <div class="grid grid-cols-1 gap-48 items-center">
                <div class="order-1 lg:order-2">
                    <h2 class="mb-24">{professionalHeader}</h2>
                    {formatParagraphs(professionalContent).map((paragraph: string) => (
                        <p class="text-lg text-muted-foreground mb-24 leading-relaxed">
                            {paragraph}
                        </p>
                    ))}
                </div>
            </div>
        </div>
    </section>

    <!-- Credentials & Training -->
    <section class="py-48 bg-muted/30">
        <div class="max-w-6xl mx-auto container-padding">
            <div class="text-center mb-64">
                <h2 class="mb-24">{certificationsHeader}</h2>
                <p class="text-xl text-muted-foreground max-w-3xl mx-auto">
                    {certificationsDescription}
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-32">
                {certificationsContent.map((cert: any, index: number) => (
                    <div class="bg-card rounded-lg shadow-sm">
                        <div class="p-32 text-center">
                            <div
                                class={`w-16 h-16 ${index % 2 === 0 ? 'bg-primary/10' : 'bg-secondary/10'} rounded-full flex items-center justify-center mx-auto mb-24`}
                            >
                                <span class={`${index % 2 === 0 ? 'text-primary' : 'text-secondary'} font-bold`}>
                                    {cert.abbreviation}
                                </span>
                            </div>
                            <h3 class="mb-16">{cert.header}</h3>
                            <p class="text-muted-foreground">
                                {cert.description}
                            </p>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    </section>

    <!-- Approach & Philosophy -->
    <section class="py-48">
        <div class="max-w-6xl mx-auto container-padding">
            <div class="text-center mb-64">
                <h2 class="mb-24">{approachHeader}</h2>
                <p class="text-xl text-muted-foreground max-w-3xl mx-auto">
                    {approachDescription}
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-48">
                {approachContent.map((approach: any, index: number) => (
                    <div class={index === approachContent.length - 1 && approachContent.length % 2 !== 0 ? "md:col-span-2 md:max-w-xl md:mx-auto" : ""}>
                        <h3 class="mb-24">{approach.name}</h3>
                        <p class={`text-lg text-muted-foreground ${index < approachContent.length - 2 ? 'mb-32' : ''} leading-relaxed`}>
                            {approach.body}
                        </p>
                    </div>
                ))}
            </div>
        </div>
    </section>

    <!-- Personal Touch -->
    <section class="py-48 bg-muted/30">
        <div class="max-w-4xl mx-auto container-padding text-center">
            <h2 class="mb-24">{beyondHeader}</h2>
            <p class="text-xl text-muted-foreground mb-32 leading-relaxed">
                {beyondDescription}
            </p>
        </div>
    </section>
</Layout>